## Summary
Go to the top floor in Jack's Frost Tower and click on the printer, which sends you to https://printer.kringlecastle.com/.\
Objective: "Investigate the stolen Kringle Castle printer. Get shell access to read the contents of /var/spool/printer.log. What is the name of the last file printed (with a .xlsx extension)? Find Ruby Cyster in Jack's office for help with this objective."

Ruby Cyster tells you to talk to the elf on Santa's Castle's NetWars roof, who tells you to solve the Sleigh challenge behind him, then he'll give you shellcode tips. His tip is pretty useless, but here it is anyways...

Chimney Scissorsticks' Hint:
"Lastly, be careful not to overwrite any register values you need to reference later on in your shellcode."

## Steps
Complete the 11 Shellcode Primer lessons. 1-10 are good, guided tutorials, while 11 is the challenge. Read everything closely - you can't expect to skim and guess till you pass here. On 11, know that you can assign one REG to another, using `mov REG1, REG2` to move REG2 into REG1 position. So for example, if a syscall returns data into rax, you could move it into rdi by doing `mov rdi, rax`.


<details>
  <summary>Answer to open file</summary>
  
```
; TODO: Get a reference to this
call txt
db '/var/northpolesecrets.txt',0
txt:

; TODO: Call sys_open
mov rax, 2 ;sys_open
pop rdi
mov rsi, 0
mov rdx, 0
syscall
```
  
</details>

<details>
  <summary>Answer to read file</summary>
  
```
; TODO: Call sys_read on the file handle and read it into rsp
mov rdi, rax
mov rax, 0 ;sys_read
mov rdx, 200 ;size_t count
mov rsi, rsp
syscall
```
  
</details>

<details>
  <summary>Answer to write to STDOUT</summary>
  
```
; TODO: Call sys_write to write the contents from rsp to stdout (1)
mov rax, 1;sys_write
mov rdi,1
mov rsi, rsp
mov rdx, 200 ;size_t count
syscall
```
  
</details>

<details>
  <summary>Answer exit cleanly</summary>
  
```
; TODO: Call sys_exit
mov rax, 60;sys_exit
mov rdi, 99;Put the exit_code we want (99) in rdi
syscall
ret
```
  
</details>


<details>
  <summary>Answer</summary>
  Secret to KringleCon success: all of our speakers and organizers, providing the gift of cyber security knowledge, free to the community.
</details>
